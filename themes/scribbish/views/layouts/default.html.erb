<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <%= page_header %>
  <title><%=h page_title %></title>
  <%= stylesheet_link_tag '/stylesheets/theme/application.css', :media => 'all' %>
  <!-- Prism.js for syntax highlighting with line numbers -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
</head>

<body>
<div id="container">
  <div id="header">
    <h1><span><%= link_to this_blog.blog_name, this_blog.base_url %></span></h1>
    <h2><%= this_blog.blog_subtitle %></h2>
  </div>

  <div id="page">
    <div id="content">
      <%= yield %>
      <%= javascript_tag 'show_dates_as_local_time()' %>
    </div>

    <div id="sidebar">
      <!-- sidebar components -->
      <%= render_sidebars %>
    </div>
    <br style="clear:both;" />
  </div>

  <div id="footer">
    <hr />
    <p><%= link_to this_blog.blog_name, this_blog.base_url %></p>
    <ul>
      <li>
        <%= _("Powered by %s", link_to('typo', 'http://typosphere.org')) %> /
        <%= _("styled with %s", link_to('scribbish', 'http://quotedprintable.com/pages/scribbish'))%>
      </li>
    </ul>
  </div>
</div>

<!-- Prism.js core and language support -->
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script>
  // Setup Prism.js syntax highlighting
  document.addEventListener('DOMContentLoaded', function() {
    // Copy language class from code to pre element (Kramdown puts it on code)
    document.querySelectorAll('pre > code[class*="language-"]').forEach(function(code) {
      var pre = code.parentElement;
      var langClass = Array.from(code.classList).find(function(c) { return c.startsWith('language-'); });
      if (langClass && !pre.classList.contains(langClass)) {
        pre.classList.add(langClass);
      }
      pre.classList.add('line-numbers');
    });

    // Also add line-numbers to any other pre elements
    document.querySelectorAll('pre:not(.line-numbers)').forEach(function(pre) {
      if (pre.querySelector('code')) {
        pre.classList.add('line-numbers');
      }
    });

    // Run Prism highlighting
    if (typeof Prism !== 'undefined') {
      Prism.highlightAll();
    }
  });
</script>
</body>
</html>
